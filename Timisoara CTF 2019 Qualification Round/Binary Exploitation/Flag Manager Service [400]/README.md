# Flag Manager Service [400]
**Category:** Binary Exploitation 

> Our spies found this flag manager service running on the ctf server. It needs a password tho, but I am sure you can handle it.  
nc 89.38.208.144 11115

## Write-up
Analysis of the binary with Ghidra shows this is a standard ret2libc buffer overflow. `libc-2.27.so` being provided reinforces the challenge being a ret2libc.

As usual, all ret2libc exploits have the following order:
1. **Leak the address of puts**  
Leak the address of `puts` using `puts` to output the address. Essentially, just call `puts(puts_got)`, where `puts_got` is the address of `puts`in the `GLOBAL OFFSET TABLE (GOT)`
2. **Calculate the libc base**  
Libc base can be calculated using `puts` - `puts_offset`, where `puts` is the leaked address and `puts_offset` is the address of `puts` in libc. 
3. **Calculate system and /bin/sh address**    
With libc base value, the address of `system` and the string `/bin/sh\x00` can be calculated using `libc_base + system_offset` and `libc_base + binsh_offset` respectively.
4. **Call system(/bin/sh)**  
Overflow the buffer and call `system(/bin/sh)`, which executes shell. Before calling `system(/bin/sh)`, the `RSI` register has to be set to 0, or the call will not work.

**Flag:** TIMCTF{d3v_fd_i5_sn3aky_backd00r}
